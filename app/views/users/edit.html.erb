<div class='container-fluid'>
  <div class='row'>
    <div class="col-sm-12 col-md-8 col-lg-5 px-5 px-sm-0 mx-auto">
    <h2>User info</h2>
    <%= form_with model:@user, local:true do |f| %>
      <!--%= render 'layouts/errors', obj: @user %>-->
      <div class="form-group">
        <%= f.label :name %>
        <%= f.text_field :name, class: "name", placeholder: "(30文字以内)" %>
      </div>
     <div class="form-group">
        <%= f.label :image %>
        <%= f.file_field :profile_image, class: "form-control-file user_image", accept: 'image/*', id: 'image-upload'%>
      </div>

      <div class="form-group">
        <%= image_tag '', id: 'image-preview', class: 'preview-image' %>
      </div>

      <div class="form-group">
        <%= f.label :Profile %>
        <%= f.text_area :introduction, class: "form-control introduction", placeholder: "(30文字以内)" %>
      </div>
      <div class="form-group">
        <%= f.submit class: 'btn btn-secondary' %>
      </div>
    <% end %>
  </div>
</div>


<script>
  document.addEventListener('DOMContentLoaded', () => {
    const input = document.getElementById('image-upload');
    const preview = document.getElementById('image-preview');
    preview.setAttribute('style','width: 200px; object-fit: cover;')

  input.addEventListener('change', () => {
    const file = input.files[0];
    const reader = new FileReader();

  reader.onload = () => {
    preview.src = reader.result;
    }

    if (file) {
      reader.readAsDataURL(file);
      }
    });
  });
</script>